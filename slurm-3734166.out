wandb: Using wandb-core as the SDK backend. Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: mattias421. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.18.3
wandb: Run data is saved locally in ./results/vanilla/wandb/run-20250203_140049-etonvny1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cfm_v2_maybe_stable
wandb: ‚≠êÔ∏è View project at https://wandb.ai/mattias421/tdmolflow
wandb: üöÄ View run at https://wandb.ai/mattias421/tdmolflow/runs/etonvny1
using rdkit
parse_int_list 0,0,0,1,1,1,1,1,1
parse_int_list 1,1,1,1,1,1,1,1,1
seed:  870871973
Creating output directory...
Loading dataset...
training.dataset.QM9Dataset () {'only_second_half': False, 'shuffle_node_ordering': True, 'charge_norm': 10.0, 'train_or_valid': 'train', 'pos_norm': 1.0, 'subset': -1, 'random_rotation': False, 'condition_on_alpha': False, 'atom_type_norm': 0.25, 'remove_h': False}
------- making QM9 dataset --------
Entropy of n_nodes: H[N] -2.475700616836548
QM9 Dataset Length 100000
/fastdata/acq22mc/anaconda/.envs/tdmolflow/lib/python3.11/site-packages/torch/utils/data/sampler.py:65: UserWarning: `data_source` argument is not used and will be removed in 2.2.0.You may still have custom implementation that utilizes it.
  warnings.warn("`data_source` argument is not used and will be removed in 2.2.0."
/fastdata/acq22mc/anaconda/.envs/tdmolflow/lib/python3.11/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 8 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
training.dataset.QM9Dataset () {'only_second_half': False, 'shuffle_node_ordering': True, 'charge_norm': 10.0, 'train_or_valid': 'valid', 'pos_norm': 1.0, 'subset': -1, 'random_rotation': False, 'condition_on_alpha': False, 'atom_type_norm': 0.25, 'remove_h': False}
------- making QM9 dataset --------
Entropy of n_nodes: H[N] -2.475700616836548
QM9 Dataset Length 100000
Created structure with observedness [0 0 0 1 1 1 1 1 1]
Constructing network...
training.networks.EpsilonPrecond () {'model_type': 'EGNNMultiHeadJump', 'transformer_dim': 128, 'detach_last_layer': True, 'n_attn_blocks': 8, 'n_heads': 8, 'rate_use_x0_pred': True, 'noise_embed': 'ts*1000', 'use_fp16': False, 'augment_dim': 9, 'structure': <training.structure.Structure object at 0x2b31ef20f190>}
num parameters:  7327554
training.sampler.JumpSampler () {'guidance_weight': 1.0, 'do_conditioning': False, 'dt_schedule_l': 0.001, 'do_jump_corrector': False, 'condition_sweep_path': None, 'dt_schedule_tc': 0.5, 'corrector_start_time': 0.1, 'dt': 0.001, 'dt_schedule': 'uniform', 'corrector_snr': 0.1, 'corrector_steps': 0, 'condition_sweep_idx': 0, 'corrector_finish_time': 0.003, 'dt_schedule_h': 0.05, 'no_noise_final_step': False, 'sample_near_atom': True, 'condition_type': 'sweep', 'structure': <training.structure.Structure object at 0x2b31ef20f190>}
training.grad_conditioning.MoleculeJump () {'lr_rampup_kimg': 320, 'grad_norm_clip': 1.0}
Setting up optimizer...
training.loss.JumpLossFinalDim () {'mean_or_sum_over_dim': 'mean', 'auto_loss_weight': 1.0, 'score_loss_weight': 1.0, 'min_t': 0.001, 'vp_sde_beta_max': 20.0, 'x0_logit_ce_loss_weight': 1.0, 'rate_loss_weight': 1.0, 'nearest_atom_pred': True, 'rate_cut_t': 0.1, 'rate_function_name': 'step', 'vp_sde_beta_min': 0.1, 'loss_type': 'eps', 'nearest_atom_loss_weight': 1.0, 'noise_schedule_name': 'cfm_ode', 'structure': <training.structure.Structure object at 0x2b31ef20f190>}
torch.optim.Adam () {'params': <generator object Module.parameters at 0x2b321b637140>, 'lr': 3e-05, 'betas': [0.9, 0.999], 'eps': 1e-08}
Training for 200000 kimg...

tick 0     kimg 0.1       time 44s          sec/tick 7.9     sec/kimg 124.08  iters/sec 0.12592998362038074 maintenance 36.4   cpumem 1.72   gpumem 11.88  reserved 12.35 
---------- jump sampler -------------
-------- finish sampling ---------
nfe:  1000
[14:04:19] Explicit valence for atom # 0 F, 12, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 10, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 6, is greater than permitted
[14:04:19] Explicit valence for atom # 0 N, 9, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 5, is greater than permitted
[14:04:19] Explicit valence for atom # 0 N, 10, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 5, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 8, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 5, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 6, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 11, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 2, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 6, is greater than permitted
[14:04:19] Explicit valence for atom # 0 N, 6, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 6, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 7, is greater than permitted
[14:04:19] Explicit valence for atom # 0 C, 5, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 3, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 2, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 3, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 2, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 6, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 10, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 10, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 4, is greater than permitted
[14:04:19] Explicit valence for atom # 0 H, 4, is greater than permitted
[14:04:19] Explicit valence for atom # 0 N, 4, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 5, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 4, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 5, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 4, is greater than permitted
[14:04:19] Explicit valence for atom # 0 H, 3, is greater than permitted
[14:04:19] Explicit valence for atom # 0 H, 6, is greater than permitted
[14:04:19] Explicit valence for atom # 0 N, 10, is greater than permitted
[14:04:19] Explicit valence for atom # 0 F, 3, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 8, is greater than permitted
[14:04:20] Explicit valence for atom # 0 N, 13, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 3, is greater than permitted
[14:04:20] Explicit valence for atom # 1 F, 5, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 7, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 5, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 7, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 3, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 9, is greater than permitted
[14:04:20] Explicit valence for atom # 2 F, 3, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 5, is greater than permitted
[14:04:20] Explicit valence for atom # 0 H, 5, is greater than permitted
[14:04:20] Explicit valence for atom # 0 H, 2, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 9, is greater than permitted
[14:04:20] Explicit valence for atom # 1 F, 2, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 7, is greater than permitted
[14:04:20] Explicit valence for atom # 0 H, 2, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 3, is greater than permitted
[14:04:20] Explicit valence for atom # 0 N, 6, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 7, is greater than permitted
[14:04:20] Explicit valence for atom # 3 F, 7, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 2, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 7, is greater than permitted
[14:04:20] Explicit valence for atom # 0 H, 6, is greater than permitted
[14:04:20] Explicit valence for atom # 0 N, 4, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 4, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 6, is greater than permitted
[14:04:20] Explicit valence for atom # 2 O, 8, is greater than permitted
[14:04:20] Explicit valence for atom # 0 F, 5, is greater than permitted
Validity over 64 molecules: 0.00%
slurmstepd: error: *** JOB 3734166 ON bessemer-node026 CANCELLED AT 2025-02-03T14:07:48 ***
